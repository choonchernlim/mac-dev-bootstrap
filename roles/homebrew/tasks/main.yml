---
- name: Turn off analytics
  shell: brew analytics off
  register: homebrew_analytics_off_output
  changed_when: homebrew_analytics_off_output.rc != 0

- name: Update Homebrew and upgrade all existing packages
  homebrew:
    update_homebrew: yes
    upgrade_all: yes

- name: Tap homebrew/cask-fonts for installing Nerd Fonts
  homebrew_tap:
    name: homebrew/cask-fonts
    state: present

# homebrew_cask doesn't work with tapped repo... so, run the command directly
- name: Install Nerd Fonts
  shell: brew install --cask font-hack-nerd-font
  register: homebrew_install_nerd_fonts_output
  changed_when: not 'is already installed' in homebrew_install_nerd_fonts_output.stderr

- name: Install cask packages
  homebrew_cask:
    name: '{{ item }}'
    state: present
  loop: '{{ homebrew_cask_packages }}'

- name: Install packages
  homebrew:
    name: '{{ item }}'
    state: present
  loop: '{{ homebrew_packages }}'
